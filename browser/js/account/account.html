<section id="account">

  <div class="container">
    <div class="col-md-12">
      <h2>My Account</h2>
      <table>
        <tr>
          <th>Username</th>
          <td>{{user.username}}</td>
        </tr>
        <tr>
          <th>Email</th>
          <td>{{user.email}}</td>
        </tr>
        <tr>
          <th>User since</th>
          <td>{{user.joinDate | date : 'mediumDate'}}</td>
        </tr>
        <tr>
          <th>No. of Reviews</th>
          <td>{{user.reviews.length}}</td>
        </tr>
      </table>
      <hr>
    </div>
  </div>

  <div class="container">
  
    <div class="col-md-6">
      <h3>My Orders</h3>
      <p ng-show="!orders.length">You haven't placed any orders yet! <a href="" ui-sref="wines">Go shopping?</a></p>
      <div class="panel panel-default" ng-repeat="order in orders">
        <h4>Order Placed on {{order.date | date : short}}</h4>
        <small><strong>Status:</strong> {{order.status}}</small>
        <button ng-show="order.status === pending" class="btn btn-danger" ng-click="cancelOrder(order)">Cancel Order</button>
        <p ng-show="order.status === shipped">This order was shipped to: 
          <br>{{order.shippingAddress.street}}
          <br>{{order.shippingAddress.city}}, {{order.shippingAddress.state}}
          <br>{{order.shippingAddress.zip}}
        </p>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in order.items">
              <th>{{item.wine | displayName}}</th>
              <td>{{item.price | currency}}</td>
              <td>x{{item.quantity}}</td>
              <td>{{item.quantity * item.price | currency}}</td>
            </tr>
            <tr>
              <th>Shipping</th>
              <td></td>
              <td>{{order.shippingRate}}</td>
              <td>{{getShippingCost(order)}}</td>
            </tr>
            <tr>
              <th>Tax</th>
              <td></td>
              <td>{{order.tax * 100}}%</td>
              <td>{{order.total * order.tax | currency}}</td>
            </tr>
          </tbody>
          <p><strong>Order Total: {{order.total}}</strong></p>
      </div>
    </div>

    <div class="col-md-6">
      <h3>My Reviews</h3>
      <p ng-show="!user.reviews.length">You haven't left any reviews yet!</p>
      <div class="panel panel-default" ng-repeat="review in user.reviews">
        <h4>{{review.title}}</h4>
        <stars rating="review.stars"></stars>
        <p>{{review.content}}</p>
        <button class="btn btn-primary" ng-click="editReview(review)">Edit</button>
        <button class="btn btn-danger" ng-click="deleteReview(review)">Delete</button>
      </div>
    </div>

  </div>
  
</section>